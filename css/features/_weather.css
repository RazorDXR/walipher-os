/* Weather Widget & Themes */

/* Widget in Header Pill */
.weather-widget {
    display: flex;
    align-items: center;
    gap: 10px;
}

.weather-icon {
    font-size: 1.2rem;
    filter: drop-shadow(0 0 8px var(--cyan));
}

.weather-info {
    display: flex;
    align-items: center;
    gap: 8px;
    line-height: 1;
}

#weather-temp {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.95rem;
    font-weight: 700;
    color: var(--cyan);
}

.demo-badge {
    font-size: 0.6rem;
    background: rgba(245, 158, 11, 0.2);
    color: #fbbf24;
    padding: 1px 3px;
    border-radius: 3px;
    border: 1px solid rgba(245, 158, 11, 0.4);
    margin-left: 5px;
}

#weather-desc {
    font-size: 0.9rem;
    color: #e2e8f0;
    text-transform: capitalize;
    opacity: 0.9;
}

/* --- NEW LAYER SYSTEM (Mobile Fix) --- */
.weather-layer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    transition: opacity 1s ease, background 1s ease;
}

#weather-background-layer {
    z-index: -2;
    background: var(--dark-bg);
    /* Fallback */
}

#weather-fx-layer {
    z-index: -1;
    opacity: 0;
}

/* Dynamic Themes applied to Layers via Body Class */

/* Clear Day */
body.theme-clear-day #weather-background-layer {
    background: radial-gradient(circle at top center, #0f172a 0%, #020617 100%);
}

body.theme-clear-day #weather-background-layer::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(56, 189, 248, 0.15) 0%, transparent 40%);
}

/* Clear Night */
body.theme-clear-night #weather-background-layer {
    background: linear-gradient(to bottom, #020617 0%, #000000 100%);
}

/* Sunrise */
body.theme-sunrise #weather-background-layer {
    background: linear-gradient(135deg, #1e1b4b 0%, #7c2d12 100%);
}

/* Sunset */
body.theme-sunset #weather-background-layer {
    background: linear-gradient(to bottom left, #4c1d95 0%, #9a3412 100%);
}

/* Cloudy */
body.theme-cloudy #weather-background-layer {
    background: linear-gradient(to bottom, #1e293b 0%, #0f172a 100%);
}

/* Rain */
body.theme-rain #weather-background-layer {
    background: linear-gradient(to bottom, #0f172a 0%, #1e293b 100%);
}

body.theme-rain #weather-fx-layer {
    opacity: 0.4;
    background-image: url("data:image/svg+xml,%3Csvg width='500' height='500' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3ClinearGradient id='a' x1='0' x2='0' y1='0' y2='1'%3E%3Cstop offset='0' stop-color='white' stop-opacity='0'/%3E%3Cstop offset='0.5' stop-color='white' stop-opacity='0.4'/%3E%3Cstop offset='1' stop-color='white' stop-opacity='0'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect x='50' y='0' width='1' height='60' fill='url(%23a)'/%3E%3Crect x='150' y='120' width='1' height='40' fill='url(%23a)'/%3E%3Crect x='280' y='200' width='1' height='70' fill='url(%23a)'/%3E%3Crect x='420' y='60' width='1' height='50' fill='url(%23a)'/%3E%3Crect x='90' y='350' width='1' height='60' fill='url(%23a)'/%3E%3Crect x='340' y='400' width='1' height='45' fill='url(%23a)'/%3E%3C/svg%3E");
    background-size: 500px 500px;
    animation: rain-fall 0.8s linear infinite;
}

/* Storm */
body.theme-storm #weather-background-layer {
    background: linear-gradient(to bottom, #334155 0%, #020617 100%);
}

body.theme-storm #weather-fx-layer {
    opacity: 0.4;
    background-image: url("data:image/svg+xml,%3Csvg width='500' height='500' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3ClinearGradient id='a' x1='0' x2='0' y1='0' y2='1'%3E%3Cstop offset='0' stop-color='white' stop-opacity='0'/%3E%3Cstop offset='0.5' stop-color='white' stop-opacity='0.4'/%3E%3Cstop offset='1' stop-color='white' stop-opacity='0'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect x='50' y='0' width='1' height='60' fill='url(%23a)'/%3E%3Crect x='150' y='120' width='1' height='40' fill='url(%23a)'/%3E%3Crect x='280' y='200' width='1' height='70' fill='url(%23a)'/%3E%3Crect x='420' y='60' width='1' height='50' fill='url(%23a)'/%3E%3Crect x='90' y='350' width='1' height='60' fill='url(%23a)'/%3E%3Crect x='340' y='400' width='1' height='45' fill='url(%23a)'/%3E%3C/svg%3E");
    background-size: 500px 500px;
    animation: rain-fall 0.5s linear infinite;
}

body.theme-storm #weather-fx-layer::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: white;
    opacity: 0;
    z-index: 10;
    animation: flash 15s infinite;
}

/* Hide Ambient Lights in Heavy Weather */
body.theme-rain .ambient-light,
body.theme-storm .ambient-light {
    opacity: 0;
}

/* Animations */
@keyframes rain-fall {
    from {
        background-position: 0 0;
    }

    to {
        background-position: 0 500px;
    }
}

@keyframes flash {

    0%,
    90% {
        opacity: 0;
    }

    91% {
        opacity: 0.3;
    }

    92% {
        opacity: 0;
    }

    93% {
        opacity: 0.4;
    }

    94% {
        opacity: 0;
    }

    96% {
        opacity: 0.2;
    }

    97% {
        opacity: 0;
    }

    100% {
        opacity: 0;
    }
}

/* Grid for Settings */
.weather-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
}